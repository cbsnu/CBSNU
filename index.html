<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CBSN-U: Set Your Limits Beyond The Sky</title> <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>

    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-storage-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-analytics-compat.js"></script>

    <style>
        /* General Body and HTML Reset */
        body {
            margin: 0;
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            color: #E0E0E0; /* Light grey text for dark theme */
            background-color: #1a1a2e; /* Dark background */
            scroll-behavior: smooth;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: auto;
            overflow: hidden;
            padding: 20px 0;
        }

        /* Section Styling */
        section {
            padding: 80px 0;
            margin-bottom: 20px;
            border-bottom: 1px solid #333;
        }

        section:last-of-type {
            border-bottom: none;
        }

        h1, h2, h3 {
            font-family: 'Montserrat', sans-serif;
            color: #FF6B6B;
            text-align: center;
            margin-bottom: 30px;
        }

        h2 {
            font-size: 2.5em;
        }

        /* Navbar Styling */
        .navbar {
            background-color: #0F0F1A;
            color: #fff;
            padding: 10px 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0,0,0,0.5);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            padding: 10px 5%;
        }

        .navbar .logo {
            font-size: 1.8em;
            font-weight: bold;
            color: #FF6B6B;
            text-decoration: none;
            display: flex;
            align-items: center;
        }

        .navbar .logo img {
            height: 40px;
            margin-right: 10px;
        }

        .navbar ul {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            flex-wrap: wrap;
        }

        .navbar ul li {
            margin-left: 20px;
        }

        .navbar ul li a {
            color: #fff;
            text-decoration: none;
            padding: 5px 0;
            transition: color 0.3s ease;
        }

        .navbar ul li a:hover,
        .navbar ul li a.active {
            color: #FF6B6B;
        }

        /* Hero Section */
        #hero {
            background: url('https://placehold.co/1920x1080/1a1a2e/FFFFFF?text=Hero+Image') no-repeat center center/cover;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: #fff;
            position: relative;
            margin-top: -60px; /* Adjust for fixed navbar height */
            flex-direction: column;
        }

        #hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.6);
        }

        #hero .hero-content {
            position: relative;
            z-index: 1;
            max-width: 800px;
            padding: 20px;
        }

        #hero h1 {
            font-size: 4em;
            margin-bottom: 20px;
            color: #FF6B6B;
        }

        #hero p {
            font-size: 1.2em;
            margin-bottom: 30px;
        }

        .btn {
            display: inline-block;
            background-color: #FF6B6B;
            color: #fff;
            padding: 12px 25px;
            text-decoration: none;
            border-radius: 5px;
            transition: background-color 0.3s ease;
            border: none;
            cursor: pointer;
            font-size: 1em;
        }

        .btn:hover {
            background-color: #E65A5A;
        }

        /* About Us Section */
        #about-us {
            background-color: #2a2a3e;
            color: #E0E0E0;
            text-align: center;
        }

        #about-us p {
            max-width: 800px;
            margin: 0 auto 30px auto;
            font-size: 1.1em;
        }

        #about-us .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }

        #about-us .stat-item {
            background-color: #3a3a4e;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        #about-us .stat-item .count {
            font-size: 2.5em;
            font-weight: bold;
            color: #FF6B6B;
            margin-bottom: 10px;
        }

        #about-us .stat-item .label {
            font-size: 1.1em;
            color: #CCC;
        }

        /* Academics Section */
        #academics {
            background-color: #1a1a2e;
            color: #E0E0E0;
        }

        #academics .academic-carousel {
            display: flex;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
            gap: 20px;
            padding-bottom: 20px;
        }

        #academics .academic-item {
            flex: 0 0 auto;
            width: 300px;
            scroll-snap-align: start;
            background-color: #2a2a3e;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            text-align: center;
            padding-bottom: 20px;
        }

        #academics .academic-item img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-bottom: 1px solid #3a3a4e;
        }

        #academics .academic-item h3 {
            color: #FF6B6B;
            margin: 15px 0 10px;
            font-size: 1.5em;
        }

        #academics .academic-item p {
            padding: 0 15px;
            font-size: 0.95em;
            color: #CCC;
        }

        .downloads-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }

        .download-item {
            background-color: #2a2a3e;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            text-align: center;
            transition: transform 0.3s ease;
        }

        .download-item:hover {
            transform: translateY(-5px);
        }

        .download-item a {
            color: #FF6B6B;
            text-decoration: none;
            font-weight: bold;
        }

        /* Photo Gallery Section */
        #photo-gallery {
            background-color: #2a2a3e;
        }

        #photo-gallery .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }

        #photo-gallery .gallery-item {
            background-color: #3a3a4e;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            position: relative;
        }

        #photo-gallery .gallery-item img {
            width: 100%;
            height: 250px;
            object-fit: cover;
            display: block;
            transition: transform 0.3s ease;
        }

        #photo-gallery .gallery-item:hover img {
            transform: scale(1.05);
        }

        #photo-gallery .gallery-item .overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.7);
            color: #fff;
            padding: 10px;
            font-size: 0.9em;
            text-align: center;
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }

        #photo-gallery .gallery-item:hover .overlay {
            transform: translateY(0);
        }

        /* Announcements Section */
        #announcements {
            background-color: #1a1a2e;
        }

        .announcement-list {
            background-color: #2a2a3e;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .announcement-item {
            border-bottom: 1px solid #3a3a4e;
            padding: 15px 0;
        }

        .announcement-item:last-child {
            border-bottom: none;
        }

        .announcement-item .date {
            font-size: 0.85em;
            color: #FF6B6B;
            margin-bottom: 5px;
        }

        .announcement-item p {
            margin: 0;
            font-size: 1em;
        }

        /* Feedbacks/Testimonials Section */
        #feedbacks {
            background-color: #2a2a3e;
        }

        .feedback-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .feedback-item {
            background-color: #3a3a4e;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            font-style: italic;
            position: relative;
        }

        .feedback-item::before {
            content: '“';
            font-size: 3em;
            color: #FF6B6B;
            position: absolute;
            top: 5px;
            left: 10px;
            opacity: 0.5;
        }

        .feedback-item p {
            margin: 0 0 10px 0;
            padding-left: 20px;
        }

        .feedback-item .author {
            text-align: right;
            font-weight: bold;
            color: #FF6B6B;
            font-style: normal;
        }

        /* Contact Us Section */
        #contact-us {
            background-color: #1a1a2e;
        }

        #contact-us .contact-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .contact-info-item {
            background-color: #2a2a3e;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            text-align: center;
        }

        .contact-info-item i {
            font-size: 2.5em;
            color: #FF6B6B;
            margin-bottom: 15px;
        }

        .contact-info-item h3 {
            color: #fff;
            margin-top: 0;
            font-size: 1.3em;
        }

        .contact-info-item p, .contact-info-item a {
            color: #CCC;
            text-decoration: none;
            font-size: 1em;
            display: block;
        }

        .contact-form-container {
            background-color: #2a2a3e;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            max-width: 600px;
            margin: 40px auto;
        }

        .contact-form-container h3 {
            margin-top: 0;
            color: #FF6B6B;
        }

        .contact-form-container .form-group {
            margin-bottom: 15px;
        }

        .contact-form-container label {
            display: block;
            margin-bottom: 8px;
            color: #E0E0E0;
        }

        .contact-form-container input[type="text"],
        .contact-form-container input[type="email"],
        .contact-form-container textarea {
            width: calc(100% - 20px);
            padding: 10px;
            border: 1px solid #4a4a5e;
            border-radius: 5px;
            background-color: #3a3a4e;
            color: #E0E0E0;
            font-size: 1em;
        }

        .contact-form-container textarea {
            resize: vertical;
            min-height: 100px;
        }

        .contact-form-container input[type="submit"] {
            width: 100%;
            padding: 12px;
            background-color: #FF6B6B;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            transition: background-color 0.3s ease;
        }

        .contact-form-container input[type="submit"]:hover {
            background-color: #E65A5A;
        }

        .message-status {
            margin-top: 20px;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
        }

        .message-status.success {
            background-color: #28a745;
            color: #fff;
        }

        .message-status.error {
            background-color: #dc3545;
            color: #fff;
        }

        /* Footer Styling */
        .footer {
            background-color: #0F0F1A;
            color: #fff;
            text-align: center;
            padding: 20px 0;
            font-size: 0.9em;
            box-shadow: 0 -2px 5px rgba(0,0,0,0.5);
        }

        .footer .social-links {
            margin-bottom: 15px;
        }

        .footer .social-links a {
            color: #fff;
            font-size: 1.5em;
            margin: 0 10px;
            transition: color 0.3s ease;
        }

        .footer .social-links a:hover {
            color: #FF6B6B;
        }

        /* Chatbot Styling */
        .chatbot-icon {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: #FF6B6B;
            color: #fff;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            z-index: 1001;
            transition: transform 0.3s ease;
        }

        .chatbot-icon:hover {
            transform: scale(1.1);
        }

        .chatbot-popup {
            position: fixed;
            bottom: 100px;
            right: 30px;
            width: 350px;
            height: 450px;
            background-color: #2a2a3e;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.7);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transform: translateY(100%) scale(0.5);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease-in-out;
        }

        .chatbot-popup.open {
            transform: translateY(0) scale(1);
            opacity: 1;
            visibility: visible;
        }

        .chatbot-header {
            background-color: #FF6B6B;
            color: #fff;
            padding: 15px;
            border-top-left-radius: 10px;
            border-top-right-radius: 10px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chatbot-header .close-btn {
            background: none;
            border: none;
            color: #fff;
            font-size: 1.5em;
            cursor: pointer;
        }

        .chatbot-messages {
            flex-grow: 1;
            padding: 15px;
            overflow-y: auto;
            background-color: #1a1a2e;
            border-bottom: 1px solid #3a3a4e;
        }

        .chatbot-messages .message {
            margin-bottom: 10px;
            padding: 8px 12px;
            border-radius: 15px;
            max-width: 80%;
            word-wrap: break-word;
        }

        .chatbot-messages .message.user {
            background-color: #FF6B6B;
            color: #fff;
            align-self: flex-end;
            margin-left: auto;
            text-align: right;
        }

        .chatbot-messages .message.bot {
            background-color: #3a3a4e;
            color: #E0E0E0;
            align-self: flex-start;
            margin-right: auto;
            text-align: left;
        }

        .chatbot-input-container {
            display: flex;
            padding: 10px;
            background-color: #2a2a3e;
        }

        .chatbot-input-container input {
            flex-grow: 1;
            padding: 10px;
            border: 1px solid #4a4a5e;
            border-radius: 20px;
            background-color: #3a3a4e;
            color: #E0E0E0;
            margin-right: 10px;
            font-size: 1em;
        }

        .chatbot-input-container button {
            background-color: #FF6B6B;
            color: #fff;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .chatbot-input-container button:hover {
            background-color: #E65A5A;
        }

        /* Dashboard Styling */
        .dashboard-container {
            padding: 20px;
            background-color: #2a2a3e;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            margin-top: 50px;
            min-height: calc(100vh - 180px); /* Adjust to fill screen minus header/footer */
        }

        .dashboard-container h2 {
            color: #FF6B6B;
            text-align: center;
            margin-bottom: 30px;
        }

        .dashboard-section {
            background-color: #1a1a2e;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 25px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .dashboard-section h3 {
            color: #E0E0E0;
            margin-top: 0;
            margin-bottom: 20px;
            border-bottom: 1px solid #3a3a4e;
            padding-bottom: 10px;
            font-size: 1.5em;
        }

        .user-list, .complaint-list {
            list-style: none;
            padding: 0;
        }

        .user-item, .complaint-item {
            background-color: #2a2a3e;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .user-item span, .complaint-item span {
            color: #CCC;
        }

        .user-actions, .complaint-actions {
            display: flex;
            gap: 10px;
        }

        .user-actions button, .complaint-actions button {
            background-color: #FF6B6B;
            color: #fff;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: background-color 0.3s ease;
        }

        .user-actions button:hover, .complaint-actions button:hover {
            background-color: #E65A5A;
        }

        .user-actions .delete, .complaint-actions .delete {
            background-color: #dc3545;
        }
        .user-actions .delete:hover, .complaint-actions .delete:hover {
            background-color: #c82333;
        }

        .upload-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .upload-form input[type="text"],
        .upload-form input[type="file"],
        .upload-form textarea {
            padding: 10px;
            border: 1px solid #4a4a5e;
            border-radius: 5px;
            background-color: #3a3a4e;
            color: #E0E0E0;
            font-size: 1em;
        }

        .upload-form button {
            padding: 12px;
            background-color: #FF6B6B;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            transition: background-color 0.3s ease;
        }

        .upload-form button:hover {
            background-color: #E65A5A;
        }

        /* Auth Modals/Pages Styling (Adjusted for multipage) */
        /* For login.html, you'd set display: block for the primary auth container */
        .auth-container {
            background-color: #2a2a3e;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            max-width: 400px;
            margin: 80px auto; /* Centered for a dedicated login page */
            text-align: center;
        }

        .auth-container h2 {
            color: #FF6B6B;
            margin-bottom: 25px;
        }

        .auth-container .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .auth-container label {
            display: block;
            margin-bottom: 8px;
            color: #E0E0E0;
            font-weight: bold;
        }

        .auth-container input[type="email"],
        .auth-container input[type="password"],
        .auth-container input[type="text"],
        .auth-container select {
            width: calc(100% - 20px);
            padding: 12px;
            border: 1px solid #4a4a5e;
            border-radius: 5px;
            background-color: #3a3a4e;
            color: #E0E0E0;
            font-size: 1em;
        }

        .auth-container button {
            width: 100%;
            padding: 12px;
            background-color: #FF6B6B;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            transition: background-color 0.3s ease;
        }

        .auth-container button:hover {
            background-color: #E65A5A;
        }

        .auth-container .toggle-link {
            display: block;
            margin-top: 20px;
            color: #FF6B6B;
            text-decoration: none;
            font-size: 0.9em;
            transition: color 0.3s ease;
        }

        .auth-container .toggle-link:hover {
            color: #E65A5A;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .navbar {
                flex-direction: column;
                align-items: flex-start;
            }

            .navbar ul {
                margin-top: 10px;
                flex-direction: column;
                width: 100%;
                text-align: center;
            }

            .navbar ul li {
                margin: 5px 0;
            }

            #hero h1 {
                font-size: 3em;
            }

            section {
                padding: 50px 0;
            }

            .dashboard-container {
                padding: 15px;
            }
        }

        @media (max-width: 480px) {
            #hero h1 {
                font-size: 2.5em;
            }

            .navbar .logo {
                font-size: 1.5em;
            }

            .chatbot-popup {
                width: 90%;
                right: 5%;
                bottom: 80px;
                height: 400px;
            }

            .chatbot-icon {
                bottom: 20px;
                right: 20px;
                width: 50px;
                height: 50px;
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <header class="navbar">
        <a href="index.html" class="logo">
            <img src="images/1744649096909.png" alt="CBSN-U Logo">
            CBSN-U
        </a>
        <nav>
            <ul>
                <li><a href="index.html" class="nav-link" data-page="index">Home</a></li>
                <li><a href="about.html" class="nav-link" data-page="about">About Us</a></li>
                <li><a href="academics.html" class="nav-link" data-page="academics">Academics</a></li>
                <li><a href="gallery.html" class="nav-link" data-page="gallery">Gallery</a></li>
                <li><a href="announcements.html" class="nav-link" data-page="announcements">Announcements</a></li>
                <li><a href="feedbacks.html" class="nav-link" data-page="feedbacks">Feedbacks</a></li>
                <li><a href="contact.html" class="nav-link" data-page="contact">Contact Us</a></li>
                <li><a href="login.html" class="nav-link" data-page="login" id="loginNavLink">Login</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section id="hero">
            <div class="hero-content">
                <h1>Welcome to CBSN-U</h1>
                <p>Set Your Limits Beyond The Sky.</p>
                <a href="#about-us" class="btn">Learn More</a>
            </div>
        </section>

        <section id="about-us" class="container">
            <h2>About CBSN-U</h2>
            <p>CBSN-U (Cross Border Study Network -U) is dedicated to providing high-quality education and fostering a global learning environment.</p>
            <p>Founded by Rittik Raj, we aim to bridge educational gaps and empower students to achieve their full potential. Our head office is in Begusarai, Bihar, India, with a secondary office in California, USA (20656 but not c i r Potter and, CA 91326 USA).</p>

            <div class="stats-grid">
                <div class="stat-item">
                    <div class="count" id="studentsCount">0</div>
                    <div class="label">Students</div>
                </div>
                <div class="stat-item">
                    <div class="count" id="facultyCount">0</div>
                    <div class="label">Faculty</div>
                </div>
                <div class="stat-item">
                    <div class="count" id="institutionsCount">0</div>
                    <div class="label">Institutions</div>
                </div>
            </div>
        </section>

        <section id="academics" class="container">
            <h2>Academic Programs & Results</h2>
            <div class="academic-carousel">
                <div class="academic-item">
                    <img src="https://placehold.co/300x200/2a2a3e/FF6B6B?text=Program+1" alt="Academic Program 1">
                    <h3>Course Title 1</h3>
                    <p>Brief description of the course, its objectives, and what students will learn.</p>
                </div>
                <div class="academic-item">
                    <img src="https://placehold.co/300x200/2a2a3e/FF6B6B?text=Program+2" alt="Academic Program 2">
                    <h3>Course Title 2</h3>
                    <p>Detailed overview of another academic program offered at CBSN-U.</p>
                </div>
                <div class="academic-item">
                    <img src="https://placehold.co/300x200/2a2a3e/FF6B6B?text=Program+3" alt="Academic Program 3">
                    <h3>Course Title 3</h3>
                    <p>Information about the curriculum, duration, and career prospects.</p>
                </div>
                </div>

            <h3>Results & Certificates</h3>
            <div class="downloads-grid">
                <div class="download-item">
                    <i class="fas fa-file-pdf"></i>
                    <p>Annual Exam Results 2024</p>
                    <a href="path/to/results2024.pdf" target="_blank">Download PDF</a>
                </div>
                <div class="download-item">
                    <i class="fas fa-award"></i>
                    <p>Student Certificates Guidelines</p>
                    <a href="path/to/certificates_guidelines.pdf" target="_blank">View Details</a>
                </div>
                <div class="download-item">
                    <i class="fas fa-file-alt"></i>
                    <p>Admissions Prospectus 2025</p>
                    <a href="path/to/prospectus2025.pdf" target="_blank">Download PDF</a>
                </div>
                </div>
        </section>

        <section id="photo-gallery" class="container">
            <h2>Photo Gallery</h2>
            <div class="gallery-grid" id="photoGalleryGrid">
                <div class="gallery-item">
                    <img src="https://placehold.co/300x250/3a3a4e/FF6B6B?text=Event+1" alt="Event 1">
                    <div class="overlay">Event Name 1 - Description</div>
                </div>
                <div class="gallery-item">
                    <img src="https://placehold.co/300x250/3a3a4e/FF6B6B?text=Campus" alt="Campus">
                    <div class="overlay">Campus Life - Spring 2024</div>
                </div>
                <div class="gallery-item">
                    <img src="https://placehold.co/300x250/3a3a4e/FF6B6B?text=Graduation" alt="Graduation">
                    <div class="overlay">Graduation Ceremony 2024</div>
                </div>
            </div>
        </section>

        <section id="announcements" class="container">
            <h2>Announcements</h2>
            <div class="announcement-list" id="announcementList">
                <div class="announcement-item">
                    <div class="date">June 1, 2025</div>
                    <p>Important: Summer break starts on June 15th. Classes resume August 1st.</p>
                </div>
                <div class="announcement-item">
                    <div class="date">May 28, 2025</div>
                    <p>Workshop on AI in Education next Friday. Register now!</p>
                </div>
            </div>
        </section>

        <section id="feedbacks" class="container">
            <h2>What Our Students Say</h2>
            <div class="feedback-grid" id="feedbackGrid">
                <div class="feedback-item">
                    <p>"CBSN-U provided me with excellent learning opportunities and supportive faculty. Highly recommend!"</p>
                    <div class="author">- John Doe, Alumni</div>
                </div>
                <div class="feedback-item">
                    <p>"The online learning platform is very intuitive, and the courses are well-structured. Great experience."</p>
                    <div class="author">- Jane Smith, Student</div>
                </div>
            </div>

            <h3>Submit Your Feedback</h3>
            <div class="contact-form-container">
                <form id="feedbackForm">
                    <div class="form-group">
                        <label for="feedbackName">Your Name:</label>
                        <input type="text" id="feedbackName" required>
                    </div>
                    <div class="form-group">
                        <label for="feedbackEmail">Your Email:</label>
                        <input type="email" id="feedbackEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="feedbackMessage">Your Feedback:</label>
                        <textarea id="feedbackMessage" required></textarea>
                    </div>
                    <button type="submit" class="btn">Submit Feedback</button>
                    <div id="feedbackMessageStatus" class="message-status" style="display: none;"></div>
                </form>
            </div>
        </section>

        <section id="contact-us" class="container">
            <h2>Contact Us</h2>
            <div class="contact-grid">
                <div class="contact-info-item">
                    <i class="fas fa-map-marker-alt"></i>
                    <h3>Head Office</h3>
                    <p>Begusarai, Bihar, 851101, India</p>
                </div>
                <div class="contact-info-item">
                    <i class="fas fa-map-marker-alt"></i>
                    <h3>Secondary Office</h3>
                    <p>20656 but not c i r Potter and, CA 91326 USA</p>
                </div>
                <div class="contact-info-item">
                    <i class="fas fa-phone-alt"></i>
                    <h3>Phone Numbers</h3>
                    <p>+91 8709547748</p>
                    <p>+1 8183 8820 65</p>
                </div>
                <div class="contact-info-item">
                    <i class="fas fa-envelope"></i>
                    <h3>Email Addresses</h3>
                    <p><a href="mailto:contact.cbsnu@gmail.com">contact.cbsnu@gmail.com</a></p>
                    <p><a href="mailto:cbsnu@gmail.com">cbsnu@gmail.com</a></p>
                    <p><a href="mailto:cbsnu.contact@gmail.com">cbsnu.contact@gmail.com</a></p>
                </div>
            </div>

            <h3>Submit a Complaint or Query</h3>
            <div class="contact-form-container">
                <form id="complaintForm">
                    <div class="form-group">
                        <label for="complaintName">Your Name:</label>
                        <input type="text" id="complaintName" required>
                    </div>
                    <div class="form-group">
                        <label for="complaintEmail">Your Email:</label>
                        <input type="email" id="complaintEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="complaintSubject">Subject:</label>
                        <input type="text" id="complaintSubject" required>
                    </div>
                    <div class="form-group">
                        <label for="complaintMessage">Message:</label>
                        <textarea id="complaintMessage" required></textarea>
                    </div>
                    <button type="submit" class="btn">Submit</button>
                    <div id="complaintMessageStatus" class="message-status" style="display: none;"></div>
                </form>
            </div>
        </section>

        <div id="authModal" style="display: none;"> <div class="auth-container">
                <button class="close-btn" id="closeAuthModal" style="position: absolute; top: 10px; right: 10px; background: none; border: none; color: #E0E0E0; font-size: 1.5em; cursor: pointer;">&times;</button>
                <h2>User Authentication</h2>

                <div id="loginSection">
                    <h3>Login</h3>
                    <form id="loginForm">
                        <div class="form-group">
                            <label for="loginEmail">Email:</label>
                            <input type="email" id="loginEmail" required>
                        </div>
                        <div class="form-group">
                            <label for="loginPassword">Password:</label>
                            <input type="password" id="loginPassword" required>
                        </div>
                        <button type="submit" class="btn">Login</button>
                    </form>
                    <a href="#" class="toggle-link" id="showSignup">Don't have an account? Sign Up</a>
                    <a href="#" class="toggle-link" id="showAdminLogin">Admin Login</a>
                    <a href="#" class="toggle-link" id="showClientLogin">Client Login</a>
                    <div id="loginMessageStatus" class="message-status" style="display: none;"></div>
                </div>

                <div id="signupSection" style="display: none;">
                    <h3>Sign Up</h3>
                    <form id="signupForm">
                        <div class="form-group">
                            <label for="signupName">Full Name:</label>
                            <input type="text" id="signupName" required>
                        </div>
                        <div class="form-group">
                            <label for="signupEmail">Email:</label>
                            <input type="email" id="signupEmail" required>
                        </div>
                        <div class="form-group">
                            <label for="signupPassword">Password:</label>
                            <input type="password" id="signupPassword" required>
                        </div>
                        <div class="form-group">
                            <label for="signupRole">Role:</label>
                            <select id="signupRole" required>
                                <option value="">Select Role</option>
                                <option value="student">Student</option>
                                <option value="faculty">Faculty</option>
                            </select>
                        </div>
                        <button type="submit" class="btn">Sign Up</button>
                    </form>
                    <a href="#" class="toggle-link" id="showLogin">Already have an account? Login</a>
                    <div id="signupMessageStatus" class="message-status" style="display: none;"></div>
                </div>
            </div>
        </div>

        <div id="adminLoginModal" style="display: none;">
            <div class="auth-container">
                <button class="close-btn" id="closeAdminLoginModal" style="position: absolute; top: 10px; right: 10px; background: none; border: none; color: #E0E0E0; font-size: 1.5em; cursor: pointer;">&times;</button>
                <h3>Admin Login</h3>
                <form id="adminLoginForm">
                    <div class="form-group">
                        <label for="adminEmail">Email:</label>
                        <input type="email" id="adminEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="adminPassword">Password:</label>
                        <input type="password" id="adminPassword" required>
                    </div>
                    <button type="submit" class="btn">Login as Admin</button>
                </form>
                <div id="adminLoginMessageStatus" class="message-status" style="display: none;"></div>
            </div>
        </div>

        <div id="clientLoginModal" style="display: none;">
            <div class="auth-container">
                <button class="close-btn" id="closeClientLoginModal" style="position: absolute; top: 10px; right: 10px; background: none; border: none; color: #E0E0E0; font-size: 1.5em; cursor: pointer;">&times;</button>
                <h3>Client Login</h3>
                <form id="clientLoginForm">
                    <div class="form-group">
                        <label for="clientEmail">Email:</label>
                        <input type="email" id="clientEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="clientPassword">Password:</label>
                        <input type="password" id="clientPassword" required>
                    </div>
                    <button type="submit" class="btn">Login as Client</button>
                </form>
                <div id="clientLoginMessageStatus" class="message-status" style="display: none;"></div>
            </div>
        </div>

        <section id="facultyDashboard" class="container dashboard-container" style="display: none;">
            <h2>Faculty Dashboard</h2>
            <p>Welcome, Faculty Member!</p>

            <div class="dashboard-section">
                <h3>Assignments</h3>
                <form id="assignmentUploadForm" class="upload-form">
                    <label for="assignmentTitle">Assignment Title:</label>
                    <input type="text" id="assignmentTitle" required>

                    <label for="assignmentDescription">Description:</label>
                    <textarea id="assignmentDescription" rows="3"></textarea>

                    <label for="assignmentFile">Upload File (PDF/DOCX):</label>
                    <input type="file" id="assignmentFile" accept=".pdf,.doc,.docx" required>

                    <button type="submit">Upload Assignment</button>
                    <div id="assignmentUploadStatus" class="message-status" style="display: none;"></div>
                </form>
            </div>

            <div class="dashboard-section">
                <h3>Your Students</h3>
                <ul class="user-list" id="facultyStudentList">
                    <li><span>Student A (studentA@example.com)</span></li>
                    <li><span>Student B (studentB@example.com)</span></li>
                </ul>
            </div>
        </section>

        <section id="adminDashboard" class="container dashboard-container" style="display: none;">
            <h2>Admin Dashboard</h2>
            <p>Welcome, Administrator!</p>

            <div class="dashboard-section">
                <h3>Manage Users</h3>
                <ul class="user-list" id="userManagementList">
                    <li><span>Admin User (admin@example.com) - Role: admin</span>
                        <div class="user-actions">
                            <button class="edit">Edit</button>
                            <button class="delete">Delete</button>
                        </div>
                    </li>
                    <li><span>Faculty User (faculty@example.com) - Role: faculty</span>
                        <div class="user-actions">
                            <button class="edit">Edit</button>
                            <button class="delete">Delete</button>
                        </div>
                    </li>
                    <li><span>Student User (student@example.com) - Role: student</span>
                        <div class="user-actions">
                            <button class="edit">Edit</button>
                            <button class="delete">Delete</button>
                        </div>
                    </li>
                </ul>
            </div>

            <div class="dashboard-section">
                <h3>Post Announcement</h3>
                <form id="announcementUploadForm" class="upload-form">
                    <label for="announcementText">Announcement Text:</label>
                    <textarea id="announcementText" rows="4" required></textarea>
                    <button type="submit">Post Announcement</button>
                    <div id="announcementUploadStatus" class="message-status" style="display: none;"></div>
                </form>
            </div>

            <div class="dashboard-section">
                <h3>Upload Gallery Photo</h3>
                <form id="galleryUploadForm" class="upload-form">
                    <label for="galleryImage">Select Image:</label>
                    <input type="file" id="galleryImage" accept="image/*" required>
                    <label for="galleryCaption">Caption:</label>
                    <input type="text" id="galleryCaption" placeholder="Optional caption">
                    <button type="submit">Upload Photo</button>
                    <div id="galleryUploadStatus" class="message-status" style="display: none;"></div>
                </form>
            </div>

            <div class="dashboard-section">
                <h3>Manage Feedbacks</h3>
                <ul class="complaint-list" id="adminFeedbackList">
                    <li><span>Feedback from John (john@example.com): "Great website!"</span>
                        <div class="complaint-actions">
                            <button class="delete">Delete</button>
                        </div>
                    </li>
                </ul>
            </div>

            <div class="dashboard-section">
                <h3>Review Complaints</h3>
                <ul class="complaint-list" id="adminComplaintList">
                    <li><span>Complaint from Jane (jane@example.com) - Subject: Issue with login</span>
                        <div class="complaint-actions">
                            <button class="resolve">Mark Resolved</button>
                            <button class="delete">Delete</button>
                        </div>
                    </li>
                </ul>
            </div>
        </section>

    </main>

    <footer class="footer">
        <div class="social-links">
            <a href="#" target="_blank"><i class="fab fa-instagram"></i></a>
            <a href="#" target="_blank"><i class="fab fa-facebook-f"></i></a>
            <a href="#" target="_blank"><i class="fab fa-linkedin-in"></i></a>
            <a href="#" target="_blank"><i class="fab fa-youtube"></i></a>
        </div>
        <p>&copy; 2025 CBSN-U. All Rights Reserved.</p>
    </footer>

    <div class="chatbot-icon" id="chatbotIcon">
        <i class="fas fa-comments"></i>
    </div>

    <div class="chatbot-popup" id="chatbotPopup">
        <div class="chatbot-header">
            CBSN-U Bot
            <button class="close-btn" id="closeChatbotBtn">&times;</button>
        </div>
        <div class="chatbot-messages" id="chatbotMessages">
            <div class="message bot">Hello! I'm your CBSN-U assistant. How can I help you today?</div>
        </div>
        <div class="chatbot-input-container">
            <input type="text" id="chatbotInput" placeholder="Type your message...">
            <button id="sendChatbotBtn"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>

    <script>
        // Firebase Configuration (THIS BLOCK MUST BE COPIED TO EACH HTML FILE)
        const firebaseConfig = {
            apiKey: "AIzaSyCPN3VAXottCg3vDr0fMSu1niSVGNT3V9o",
            authDomain: "cbsnu-d8dbb.firebaseapp.com",
            projectId: "cbsnu-d8dbb",
            storageBucket: "cbsnu-d8dbb.firebasestorage.app",
            messagingSenderId: "1066269637289",
            appId: "1:1066269637289:web:cb1977ba240e05a0b587b8",
            measurementId: "G-TMBEL8E5ZQ"
        };
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const storage = firebase.storage();
        const analytics = firebase.analytics();
        console.log("Firebase initialized.");

        // EmailJS Initialization (THIS BLOCK MUST BE COPIED TO EACH HTML FILE)
        document.addEventListener('DOMContentLoaded', () => {
            emailjs.init('DqEZGom9bxso5B5Zl'); // Your EmailJS Public Key
            console.log("EmailJS initialized.");

            // --- Initial Data Loading relevant to the current page ---
            // Only call functions for sections present on THIS specific HTML page.
            const currentPath = window.location.pathname;
            if (currentPath.includes('index.html') || currentPath === '/') {
                loadAnnouncements(); // For home page announcements snippet
                loadHomePhotoGallery(); // For home page gallery snippet
                loadFeedbacks(); // For home page feedbacks snippet
                updateCounts(); // For home page stats
            } else if (currentPath.includes('about.html')) {
                updateCounts(); // Only stats needed on About Us page
            } else if (currentPath.includes('announcements.html')) {
                loadAnnouncements(); // Load all announcements
            } else if (currentPath.includes('gallery.html')) {
                loadAllPhotoGallery(); // Load all gallery items
            } else if (currentPath.includes('feedbacks.html')) {
                loadFeedbacks(); // Load all feedbacks
            } else if (currentPath.includes('dashboard-admin.html')) {
                loadUsers();
                loadAdminFeedbacks();
                loadComplaints();
            } else if (currentPath.includes('dashboard-faculty.html')) {
                loadFacultyStudents(); // Assuming faculty students are loaded on their dashboard
            }
        });

        // Helper function to show messages (THIS FUNCTION MUST BE COPIED TO EACH HTML FILE)
        function showMessage(elementId, message, isError) {
            const element = document.getElementById(elementId);
            if (element) { // Ensure element exists on the current page
                element.textContent = message;
                element.classList.remove('success', 'error');
                element.classList.add(isError ? 'error' : 'success');
                element.style.display = 'block';
                setTimeout(() => {
                    element.style.display = 'none';
                }, 5000);
            }
        }

        // --- Navigation Active Link Logic (THIS BLOCK MUST BE COPIED TO EACH HTML FILE) ---
        document.addEventListener('DOMContentLoaded', () => {
            const currentFileName = window.location.pathname.split('/').pop();
            const navLinks = document.querySelectorAll('.navbar ul li .nav-link');
            navLinks.forEach(link => {
                const linkHref = link.getAttribute('href');
                const linkFileName = linkHref.split('/').pop();

                if (linkFileName === currentFileName) {
                    link.classList.add('active');
                } else if (currentFileName === '' && link.getAttribute('data-page') === 'index') {
                    // Handle case where index.html is accessed as root '/'
                    link.classList.add('active');
                }
            });
        });

        // --- Complaint Form Submission (EmailJS) (ONLY COPY TO CONTACT.HTML) ---
        const complaintForm = document.getElementById('complaintForm');
        if (complaintForm) { // Check if form exists on this page
            complaintForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const serviceID = 'service_nvwp74b'; // Your EmailJS Service ID
                const templateID = 'template_jphnhtj'; // Your EmailJS Template ID
                try {
                    const templateParams = {
                        user_name: document.getElementById('complaintName').value,
                        user_email: document.getElementById('complaintEmail').value,
                        subject: document.getElementById('complaintSubject').value,
                        message: document.getElementById('complaintMessage').value,
                        to_email: 'contact.cbsnu@gmail.com' // Your official email for complaints
                    };
                    const response = await emailjs.send(serviceID, templateID, templateParams);
                    console.log('EmailJS Success!', response.status, response.text);
                    showMessage('complaintMessageStatus', 'Complaint submitted successfully! We will review it shortly.', false);
                    complaintForm.reset();
                    // Developer Note: For a robust system, complaints should also be logged in Firestore
                    // and visible in the Admin Dashboard.
                } catch (error) {
                    console.error('EmailJS Failed...', error);
                    showMessage('complaintMessageStatus', 'Failed to submit complaint. Please try again.', true);
                }
            });
        }

        // --- Feedback Form Submission (Firestore) (ONLY COPY TO FEEDBACKS.HTML) ---
        const feedbackForm = document.getElementById('feedbackForm');
        if (feedbackForm) {
            feedbackForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const name = document.getElementById('feedbackName').value;
                const email = document.getElementById('feedbackEmail').value;
                const message = document.getElementById('feedbackMessage').value;

                try {
                    await db.collection("feedbacks").add({
                        name: name,
                        email: email,
                        message: message,
                        timestamp: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    showMessage('feedbackMessageStatus', 'Feedback submitted successfully!', false);
                    feedbackForm.reset();
                    loadFeedbacks(); // Refresh feedback list if on the same page
                } catch (error) {
                    console.error("Error submitting feedback:", error);
                    showMessage('feedbackMessageStatus', 'Failed to submit feedback. Please try again.', true);
                }
            });
        }

        // --- Chatbot Logic (THIS ENTIRE BLOCK MUST BE COPIED TO EACH HTML FILE) ---
        const chatbotIcon = document.getElementById('chatbotIcon');
        const chatbotPopup = document.getElementById('chatbotPopup');
        const closeChatbotBtn = document.getElementById('closeChatbotBtn');
        const chatbotInput = document.getElementById('chatbotInput');
        const sendChatbotBtn = document.getElementById('sendChatbotBtn');
        const chatbotMessages = document.getElementById('chatbotMessages');

        const companyDetails = {
            name: "CBSN-U (Cross Border Study Network -U)",
            slogan: "Set Your Limits Beyond The Sky.",
            type: "OPC (One Person Company)",
            headOffice: "Begusarai, Bihar, 851101, India",
            secondaryOffice: "20656 but not c i r Potter and, CA 91326 USA",
            phoneNumbers: "8709547748, +1 8183 8820 65",
            emails: "contact.cbsnu@gmail.com, cbsnu@gmail.com, cbsnu.contact@gmail.com",
            website: "cbsnu.live",
            founderCEO: "Rittik Raj",
            ceoCredentials: "B.Sc Agriculture from Ghanshyam Urvashi PG College Prayagraj, Cyber Security from Craw Cyber Security Delhi"
        };

        if (chatbotIcon) { // Ensure chatbot elements exist on the page
            chatbotIcon.addEventListener('click', () => {
                chatbotPopup.classList.toggle('open');
            });

            closeChatbotBtn.addEventListener('click', () => {
                chatbotPopup.classList.remove('open');
            });

            sendChatbotBtn.addEventListener('click', () => {
                sendMessage();
            });

            chatbotInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
        }

        function appendMessage(sender, message) {
            const messageElement = document.createElement('div');
            messageElement.classList.add('message', sender);
            messageElement.textContent = message;
            chatbotMessages.appendChild(messageElement);
            chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
        }

        async function sendMessage() {
            const userMessage = chatbotInput.value.trim();
            if (userMessage === "") return;

            appendMessage("user", userMessage);
            chatbotInput.value = "";

            const botReply = await handleChatbotMessage(userMessage);
            setTimeout(() => {
                appendMessage("bot", botReply);
            }, 500);
        }

        async function handleChatbotMessage(message) {
            const lowerCaseMessage = message.toLowerCase();
            let botReply = "";
            let emailUnsolvedQuery = false;

            if (lowerCaseMessage.includes("hello") || lowerCaseMessage.includes("hi")) {
                botReply = "Hello! How can I help you today?";
            } else if (lowerCaseMessage.includes("company name")) {
                botReply = `Our company name is ${companyDetails.name}.`;
            } else if (lowerCaseMessage.includes("slogan") || lowerCaseMessage.includes("tagline")) {
                botReply = `Our slogan is: "${companyDetails.slogan}"`;
            } else if (lowerCaseMessage.includes("type of company")) {
                botReply = `We are an ${companyDetails.type}.`;
            } else if (lowerCaseMessage.includes("head office") || lowerCaseMessage.includes("main office")) {
                botReply = `Our head office is located at: ${companyDetails.headOffice}.`;
            } else if (lowerCaseMessage.includes("secondary office")) {
                botReply = `We also have a secondary office at: ${companyDetails.secondaryOffice}.`;
            } else if (lowerCaseMessage.includes("contact number") || lowerCaseMessage.includes("phone number")) {
                botReply = `You can reach us at: ${companyDetails.phoneNumbers}.`;
            } else if (lowerCaseMessage.includes("email")) {
                botReply = `Our official email addresses are: ${companyDetails.emails}.`;
            } else if (lowerCaseMessage.includes("website")) {
                botReply = `You can visit our website at: ${companyDetails.website}.`;
            } else if (lowerCaseMessage.includes("founder") || lowerCaseMessage.includes("ceo")) {
                botReply = `Our Founder and CEO is ${companyDetails.founderCEO}.`;
            } else if (lowerCaseMessage.includes("ceo credentials")) {
                botReply = `${companyDetails.founderCEO}'s credentials: ${companyDetails.ceoCredentials}.`;
            } else if (lowerCaseMessage.includes("admissions") || lowerCaseMessage.includes("courses")) {
                botReply = "For information on admissions and courses, please check our 'Academics' section on the website or contact us directly via email.";
                emailUnsolvedQuery = true;
            } else if (lowerCaseMessage.includes("complaint")) {
                botReply = "If you have a complaint, please use the 'Complaint Form' available on our website. Would you like me to direct you there?";
            } else {
                botReply = "I'm not sure I understand. Could you please rephrase your question? If your problem is still not resolved, I can help you to send this query to our support email.";
                emailUnsolvedQuery = true;
            }

            if (emailUnsolvedQuery && !lowerCaseMessage.includes("send email")) {
                setTimeout(() => {
                    appendMessage("bot", "Type 'send email' if you'd like me to forward your last query to our support team.");
                }, 500);
            } else if (lowerCaseMessage.includes("send email") && emailUnsolvedQuery) {
                const lastUserMessageElement = chatbotMessages.querySelector('.message.user:last-child');
                const lastUserMessage = lastUserMessageElement ? lastUserMessageElement.textContent : "No recent user query.";
                await sendChatbotQueryToEmail(lastUserMessage);
                botReply = "Your query has been forwarded to our support team. We will get back to you shortly!";
                emailUnsolvedQuery = false;
            }
            return botReply;
        }

        async function sendChatbotQueryToEmail(userQuery) {
            try {
                const templateParams = {
                    from_name: 'Chatbot User',
                    from_email: 'chatbot@cbsnu.live', // A generic email for chatbot queries
                    to_email: 'contact.cbsnu@gmail.com', // Your primary contact email
                    subject: 'Unresolved Chatbot Query from Website',
                    message: `User's query: "${userQuery}"\n\nThis query was not resolved by the chatbot and requires human attention.`,
                };
                const response = await emailjs.send('service_nvwp74b', 'template_jphnhtj', templateParams); // Use your EmailJS service and template
                console.log('Chatbot Email Forwarded Successfully!', response.status, response.text);
                return true;
            } catch (error) {
                console.error('Failed to forward chatbot query via EmailJS:', error);
                return false;
            }
        }

        // --- Data Loading Functions (Implement these if needed on a specific page) ---

        // Load Announcements (Used on Home & Announcements pages)
        async function loadAnnouncements() {
            const announcementList = document.getElementById('announcementList');
            if (!announcementList) return; // Exit if element not on page

            announcementList.innerHTML = '<li>Loading announcements...</li>';
            try {
                const snapshot = await db.collection("announcements").orderBy("timestamp", "desc").limit(5).get(); // Limit for home page
                if (window.location.pathname.includes('announcements.html')) {
                    // If on full announcements page, load more
                    snapshot = await db.collection("announcements").orderBy("timestamp", "desc").get();
                }

                if (snapshot.empty) {
                    announcementList.innerHTML = '<li>No announcements available.</li>';
                    return;
                }
                announcementList.innerHTML = '';
                snapshot.forEach(doc => {
                    const data = doc.data();
                    const date = data.timestamp ? new Date(data.timestamp.toDate()).toLocaleDateString() : 'N/A';
                    const li = document.createElement('li');
                    li.classList.add('announcement-item');
                    li.innerHTML = `<div class="date">${date}</div><p>${data.text}</p>`;
                    announcementList.appendChild(li);
                });
            } catch (error) {
                console.error("Error loading announcements:", error);
                announcementList.innerHTML = '<li>Failed to load announcements.</li>';
            }
        }

        // Load Photo Gallery (Used on Home & Gallery pages)
        async function loadHomePhotoGallery() {
            const galleryGrid = document.getElementById('photoGalleryGrid');
            if (!galleryGrid) return; // Exit if element not on page

            galleryGrid.innerHTML = '<div>Loading gallery...</div>';
            try {
                const snapshot = await db.collection("gallery").orderBy("timestamp", "desc").limit(3).get(); // Limit for home page
                if (snapshot.empty) {
                    galleryGrid.innerHTML = '<div>No photos available.</div>';
                    return;
                }
                galleryGrid.innerHTML = ''; // Clear loading message
                snapshot.forEach(doc => {
                    const data = doc.data();
                    const div = document.createElement('div');
                    div.classList.add('gallery-item');
                    div.innerHTML = `
                        <img src="${data.imageUrl}" alt="${data.caption || 'Gallery Image'}">
                        <div class="overlay">${data.caption || 'No Caption'}</div>
                    `;
                    galleryGrid.appendChild(div);
                });
            } catch (error) {
                console.error("Error loading home gallery:", error);
                galleryGrid.innerHTML = '<div>Failed to load gallery.</div>';
            }
        }

        async function loadAllPhotoGallery() {
            const galleryGrid = document.getElementById('photoGalleryGrid');
            if (!galleryGrid) return;

            galleryGrid.innerHTML = '<div>Loading all gallery images...</div>';
            try {
                const snapshot = await db.collection("gallery").orderBy("timestamp", "desc").get();
                if (snapshot.empty) {
                    galleryGrid.innerHTML = '<div>No photos available.</div>';
                    return;
                }
                galleryGrid.innerHTML = '';
                snapshot.forEach(doc => {
                    const data = doc.data();
                    const div = document.createElement('div');
                    div.classList.add('gallery-item');
                    div.innerHTML = `
                        <img src="${data.imageUrl}" alt="${data.caption || 'Gallery Image'}">
                        <div class="overlay">${data.caption || 'No Caption'}</div>
                    `;
                    galleryGrid.appendChild(div);
                });
            } catch (error) {
                console.error("Error loading all gallery:", error);
                galleryGrid.innerHTML = '<div>Failed to load gallery.</div>';
            }
        }

        // Load Feedbacks (Used on Home & Feedbacks pages)
        async function loadFeedbacks() {
            const feedbackGrid = document.getElementById('feedbackGrid');
            if (!feedbackGrid) return;

            feedbackGrid.innerHTML = '<div>Loading feedbacks...</div>';
            try {
                const snapshot = await db.collection("feedbacks").orderBy("timestamp", "desc").limit(3).get(); // Limit for home page
                if (window.location.pathname.includes('feedbacks.html')) {
                    // If on full feedbacks page, load more
                    snapshot = await db.collection("feedbacks").orderBy("timestamp", "desc").get();
                }

                if (snapshot.empty) {
                    feedbackGrid.innerHTML = '<div>No feedbacks available.</div>';
                    return;
                }
                feedbackGrid.innerHTML = '';
                snapshot.forEach(doc => {
                    const data = doc.data();
                    const div = document.createElement('div');
                    div.classList.add('feedback-item');
                    div.innerHTML = `
                        <p>"${data.message}"</p>
                        <div class="author">- ${data.name}</div>
                    `;
                    feedbackGrid.appendChild(div);
                });
            } catch (error) {
                console.error("Error loading feedbacks:", error);
                feedbackGrid.innerHTML = '<div>Failed to load feedbacks.</div>';
            }
        }

        // Update Counts (Used on Home & About Us pages)
        async function updateCounts() {
            try {
                const studentsRef = db.collection("users").where("role", "==", "student");
                const facultyRef = db.collection("users").where("role", "==", "faculty");
                const institutionsRef = db.collection("institutions"); // Assuming you have a collection for institutions

                const [studentsSnapshot, facultySnapshot, institutionsSnapshot] = await Promise.all([
                    studentsRef.get(),
                    facultyRef.get(),
                    institutionsRef.get()
                ]);

                const studentsCount = studentsSnapshot.size;
                const facultyCount = facultySnapshot.size;
                const institutionsCount = institutionsSnapshot.size;

                document.getElementById('studentsCount') && (document.getElementById('studentsCount').textContent = studentsCount);
                document.getElementById('facultyCount') && (document.getElementById('facultyCount').textContent = facultyCount);
                document.getElementById('institutionsCount') && (document.getElementById('institutionsCount').textContent = institutionsCount);

            } catch (error) {
                console.error("Error updating counts:", error);
            }
        }

        // --- Authentication & Dashboard Logic (Only copy relevant parts to login.html, dashboard-admin.html, dashboard-faculty.html) ---

        // Authentication Elements (ONLY COPY IF YOU NEED THEM ON LOGIN.HTML, NOT FOR ALL PAGES)
        const authModal = document.getElementById('authModal');
        const closeAuthModal = document.getElementById('closeAuthModal');
        const loginSection = document.getElementById('loginSection');
        const signupSection = document.getElementById('signupSection');
        const showSignup = document.getElementById('showSignup');
        const showLogin = document.getElementById('showLogin');
        const adminLoginModal = document.getElementById('adminLoginModal');
        const clientLoginModal = document.getElementById('clientLoginModal');
        const closeAdminLoginModal = document.getElementById('closeAdminLoginModal');
        const closeClientLoginModal = document.getElementById('closeClientLoginModal');
        const showAdminLoginLink = document.getElementById('showAdminLogin');
        const showClientLoginLink = document.getElementById('showClientLogin');

        if (authModal) { // This block will only run if authModal is present (i.e., on login.html)
            // For a dedicated login.html page, you might want these modals to be shown by default
            // and hide others.
            // Example for login.html: Make loginSection visible by default
            if (loginSection) loginSection.style.display = 'block';
            if (signupSection) signupSection.style.display = 'none';
            if (adminLoginModal) adminLoginModal.style.display = 'none';
            if (clientLoginModal) clientLoginModal.style.display = 'none';
            // You can remove closeAuthModal related logic if it's not a modal but a full page.

            if (closeAuthModal) closeAuthModal.addEventListener('click', () => { /* Handle redirect or navigation */ });

            if (showSignup) {
                showSignup.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (loginSection) loginSection.style.display = 'none';
                    if (signupSection) signupSection.style.display = 'block';
                    if (adminLoginModal) adminLoginModal.style.display = 'none'; // Hide other forms
                    if (clientLoginModal) clientLoginModal.style.display = 'none';
                });
            }
            if (showLogin) {
                showLogin.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (signupSection) signupSection.style.display = 'none';
                    if (loginSection) loginSection.style.display = 'block';
                    if (adminLoginModal) adminLoginModal.style.display = 'none';
                    if (clientLoginModal) clientLoginModal.style.display = 'none';
                });
            }
            if (showAdminLoginLink) {
                showAdminLoginLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (loginSection) loginSection.style.display = 'none';
                    if (signupSection) signupSection.style.display = 'none';
                    if (clientLoginModal) clientLoginModal.style.display = 'none';
                    if (adminLoginModal) adminLoginModal.style.display = 'flex'; // Show admin login
                });
            }
            if (showClientLoginLink) {
                showClientLoginLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (loginSection) loginSection.style.display = 'none';
                    if (signupSection) signupSection.style.display = 'none';
                    if (adminLoginModal) adminLoginModal.style.display = 'none';
                    if (clientLoginModal) clientLoginModal.style.display = 'flex'; // Show client login
                });
            }
            if (closeAdminLoginModal) closeAdminLoginModal.addEventListener('click', () => { adminLoginModal.style.display = 'none'; });
            if (closeClientLoginModal) closeClientLoginModal.addEventListener('click', () => { clientLoginModal.style.display = 'none'; });
        }


        // Login Form Submission (ONLY COPY TO LOGIN.HTML)
        const loginForm = document.getElementById('loginForm');
        if (loginForm) {
            loginForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;
                try {
                    const userCredential = await auth.signInWithEmailAndPassword(email, password);
                    const user = userCredential.user;
                    const userDoc = await db.collection("users").doc(user.uid).get();
                    if (userDoc.exists) {
                        const userData = userDoc.data();
                        alert(`Login successful! Welcome ${userData.name || user.email}`);
                        if (userData.role === 'admin') {
                            window.location.href = 'dashboard-admin.html';
                        } else if (userData.role === 'faculty') {
                            window.location.href = 'dashboard-faculty.html';
                        } else {
                            window.location.href = 'index.html'; // Default for students
                        }
                    } else {
                        alert('User data not found. Please contact support.');
                        await auth.signOut(); // Sign out user if their data is missing
                    }
                } catch (error) {
                    console.error("Login failed:", error);
                    showMessage('loginMessageStatus', 'Login failed: ' + error.message, true);
                }
            });
        }

        // Signup Form Submission (ONLY COPY TO LOGIN.HTML)
        const signupForm = document.getElementById('signupForm');
        if (signupForm) {
            signupForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const name = document.getElementById('signupName').value;
                const email = document.getElementById('signupEmail').value;
                const password = document.getElementById('signupPassword').value;
                const role = document.getElementById('signupRole').value;

                try {
                    const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                    const user = userCredential.user;
                    await db.collection("users").doc(user.uid).set({
                        name: name,
                        email: email,
                        role: role,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    alert('Sign up successful! Please login.');
                    signupForm.reset();
                    if (loginSection) { // Switch back to login view
                        loginSection.style.display = 'block';
                        signupSection.style.display = 'none';
                    }
                } catch (error) {
                    console.error("Sign up failed:", error);
                    showMessage('signupMessageStatus', 'Sign up failed: ' + error.message, true);
                }
            });
        }

        // Admin Login Form Submission (ONLY COPY TO LOGIN.HTML)
        const adminLoginForm = document.getElementById('adminLoginForm');
        if (adminLoginForm) {
            adminLoginForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = document.getElementById('adminEmail').value;
                const password = document.getElementById('adminPassword').value;

                try {
                    const userCredential = await auth.signInWithEmailAndPassword(email, password);
                    const user = userCredential.user;
                    const userDoc = await db.collection("users").doc(user.uid).get();

                    if (userDoc.exists && userDoc.data().role === 'admin') {
                        alert('Admin login successful!');
                        window.location.href = 'dashboard-admin.html'; // Redirect to admin dashboard
                    } else {
                        alert('Access denied. You are not an admin.');
                        await auth.signOut(); // Sign out unauthorized user
                    }
                } catch (error) {
                    console.error("Admin login failed:", error);
                    showMessage('adminLoginMessageStatus', 'Admin login failed: ' + error.message, true);
                }
            });
        }

        // Client Login Form Submission (ONLY COPY TO LOGIN.HTML)
        const clientLoginForm = document.getElementById('clientLoginForm');
        if (clientLoginForm) {
            clientLoginForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = document.getElementById('clientEmail').value;
                const password = document.getElementById('clientPassword').value;

                try {
                    const userCredential = await auth.signInWithEmailAndPassword(email, password);
                    const user = userCredential.user;
                    const userDoc = await db.collection("users").doc(user.uid).get();

                    if (userDoc.exists && userDoc.data().role === 'client') { // Assuming a 'client' role
                        alert('Client login successful!');
                        window.location.href = 'client-dashboard.html'; // Redirect to client dashboard
                    } else {
                        alert('Access denied. You are not a client.');
                        await auth.signOut(); // Sign out unauthorized user
                    }
                } catch (error) {
                    console.error("Client login failed:", error);
                    showMessage('clientLoginMessageStatus', 'Client login failed: ' + error.message, true);
                }
            });
        }

        // --- Dashboard Specific Functions ---

        // Faculty Dashboard: Upload Assignment (ONLY COPY TO DASHBOARD-FACULTY.HTML)
        const assignmentUploadForm = document.getElementById('assignmentUploadForm');
        if (assignmentUploadForm) {
            assignmentUploadForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const title = document.getElementById('assignmentTitle').value;
                const description = document.getElementById('assignmentDescription').value;
                const file = document.getElementById('assignmentFile').files[0];

                if (!file) {
                    showMessage('assignmentUploadStatus', 'Please select a file to upload.', true);
                    return;
                }

                try {
                    // Upload file to Firebase Storage
                    const storageRef = storage.ref(`assignments/${file.name}`);
                    const uploadTask = storageRef.put(file);

                    uploadTask.on('state_changed',
                        (snapshot) => {
                            const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                            showMessage('assignmentUploadStatus', `Upload is ${progress.toFixed(0)}% done`, false);
                        },
                        (error) => {
                            console.error("Upload failed:", error);
                            showMessage('assignmentUploadStatus', `Upload failed: ${error.message}`, true);
                        },
                        async () => {
                            const downloadURL = await storageRef.getDownloadURL();
                            // Save assignment details to Firestore
                            await db.collection("assignments").add({
                                title: title,
                                description: description,
                                fileUrl: downloadURL,
                                fileName: file.name,
                                uploadedBy: auth.currentUser ? auth.currentUser.uid : 'unknown',
                                timestamp: firebase.firestore.FieldValue.serverTimestamp()
                            });
                            showMessage('assignmentUploadStatus', 'Assignment uploaded successfully!', false);
                            assignmentUploadForm.reset();
                        }
                    );
                } catch (error) {
                    console.error("Error uploading assignment:", error);
                    showMessage('assignmentUploadStatus', 'Failed to upload assignment.', true);
                }
            });
        }

        // Admin Dashboard: Load & Manage Users (ONLY COPY TO DASHBOARD-ADMIN.HTML)
        async function loadUsers() {
            const userManagementList = document.getElementById('userManagementList');
            if (!userManagementList) return;

            userManagementList.innerHTML = '<li>Loading users...</li>';
            try {
                const snapshot = await db.collection("users").orderBy("createdAt", "asc").get();
                if (snapshot.empty) {
                    userManagementList.innerHTML = '<li>No users found.</li>';
                    return;
                }
                userManagementList.innerHTML = '';
                snapshot.forEach(doc => {
                    const data = doc.data();
                    const li = document.createElement('li');
                    li.classList.add('user-item');
                    li.innerHTML = `
                        <span>${data.name || data.email} - Role: ${data.role}</span>
                        <div class="user-actions">
                            <button class="edit" data-id="${doc.id}">Edit</button>
                            <button class="delete" data-id="${doc.id}">Delete</button>
                        </div>
                    `;
                    userManagementList.appendChild(li);
                });

                // Add event listeners for delete buttons
                userManagementList.querySelectorAll('.delete').forEach(button => {
                    button.addEventListener('click', async (e) => {
                        const userId = e.target.dataset.id;
                        if (confirm('Are you sure you want to delete this user?')) {
                            try {
                                await db.collection("users").doc(userId).delete();
                                alert('User deleted successfully.');
                                loadUsers(); // Refresh list
                            } catch (error) {
                                console.error("Error deleting user:", error);
                                alert('Failed to delete user: ' + error.message);
                            }
                        }
                    });
                });
                // Implement edit functionality as needed
            } catch (error) {
                console.error("Error loading users:", error);
                userManagementList.innerHTML = '<li>Failed to load users.</li>';
            }
        }

        // Admin Dashboard: Post Announcement (ONLY COPY TO DASHBOARD-ADMIN.HTML)
        const announcementUploadForm = document.getElementById('announcementUploadForm');
        if (announcementUploadForm) {
            announcementUploadForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const text = document.getElementById('announcementText').value;

                try {
                    await db.collection("announcements").add({
                        text: text,
                        timestamp: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    showMessage('announcementUploadStatus', 'Announcement posted successfully!', false);
                    announcementUploadForm.reset();
                    loadAnnouncements(); // Refresh announcements list if on the same page
                } catch (error) {
                    console.error("Error posting announcement:", error);
                    showMessage('announcementUploadStatus', 'Failed to post announcement.', true);
                }
            });
        }

        // Admin Dashboard: Upload Gallery Photo (ONLY COPY TO DASHBOARD-ADMIN.HTML)
        const galleryUploadForm = document.getElementById('galleryUploadForm');
        if (galleryUploadForm) {
            galleryUploadForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const imageFile = document.getElementById('galleryImage').files[0];
                const caption = document.getElementById('galleryCaption').value;

                if (!imageFile) {
                    showMessage('galleryUploadStatus', 'Please select an image to upload.', true);
                    return;
                }

                try {
                    // Upload image to Firebase Storage
                    const storageRef = storage.ref(`gallery/${imageFile.name}`);
                    const uploadTask = storageRef.put(imageFile);

                    uploadTask.on('state_changed',
                        (snapshot) => {
                            const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                            showMessage('galleryUploadStatus', `Upload is ${progress.toFixed(0)}% done`, false);
                        },
                        (error) => {
                            console.error("Upload failed:", error);
                            showMessage('galleryUploadStatus', `Upload failed: ${error.message}`, true);
                        },
                        async () => {
                            const downloadURL = await storageRef.getDownloadURL();
                            // Save gallery item details to Firestore
                            await db.collection("gallery").add({
                                imageUrl: downloadURL,
                                caption: caption,
                                uploadedBy: auth.currentUser ? auth.currentUser.uid : 'unknown',
                                timestamp: firebase.firestore.FieldValue.serverTimestamp()
                            });
                            showMessage('galleryUploadStatus', 'Photo uploaded successfully!', false);
                            galleryUploadForm.reset();
                            loadAllPhotoGallery(); // Refresh gallery if on the same page
                        }
                    );
                } catch (error) {
                    console.error("Error uploading gallery photo:", error);
                    showMessage('galleryUploadStatus', 'Failed to upload photo.', true);
                }
            });
        }

        // Admin Dashboard: Manage Feedbacks (ONLY COPY TO DASHBOARD-ADMIN.HTML)
        async function loadAdminFeedbacks() {
            const adminFeedbackList = document.getElementById('adminFeedbackList');
            if (!adminFeedbackList) return;

            adminFeedbackList.innerHTML = '<li>Loading feedbacks...</li>';
            try {
                const snapshot = await db.collection("feedbacks").orderBy("timestamp", "desc").get();
                if (snapshot.empty) {
                    adminFeedbackList.innerHTML = '<li>No feedbacks to display.</li>';
                    return;
                }
                adminFeedbackList.innerHTML = '';
                snapshot.forEach(doc => {
                    const data = doc.data();
                    const li = document.createElement('li');
                    li.classList.add('complaint-item'); // Reusing complaint-item class for styling
                    li.innerHTML = `
                        <span>Feedback from ${data.name || 'Anonymous'} (${data.email}): "${data.message}"</span>
                        <div class="complaint-actions">
                            <button class="delete" data-id="${doc.id}">Delete</button>
                        </div>
                    `;
                    adminFeedbackList.appendChild(li);
                });

                adminFeedbackList.querySelectorAll('.delete').forEach(button => {
                    button.addEventListener('click', async (e) => {
                        const feedbackId = e.target.dataset.id;
                        if (confirm('Are you sure you want to delete this feedback?')) {
                            try {
                                await db.collection("feedbacks").doc(feedbackId).delete();
                                alert('Feedback deleted successfully.');
                                loadAdminFeedbacks();
                            } catch (error) {
                                console.error("Error deleting feedback:", error);
                                alert('Failed to delete feedback: ' + error.message);
                            }
                        }
                    });
                });
            } catch (error) {
                console.error("Error loading admin feedbacks:", error);
                adminFeedbackList.innerHTML = '<li>Failed to load feedbacks.</li>';
            }
        }

        // Admin Dashboard: Review Complaints (ONLY COPY TO DASHBOARD-ADMIN.HTML)
        async function loadComplaints() {
            const adminComplaintList = document.getElementById('adminComplaintList');
            if (!adminComplaintList) return;

            adminComplaintList.innerHTML = '<li>Loading complaints...</li>';
            try {
                // Assuming complaints are logged to a Firestore collection 'complaints'
                // This would require modifying the EmailJS submission to also log to Firestore.
                const snapshot = await db.collection("complaints").orderBy("timestamp", "desc").get();
                if (snapshot.empty) {
                    adminComplaintList.innerHTML = '<li>No complaints to display.</li>';
                    return;
                }
                adminComplaintList.innerHTML = '';
                snapshot.forEach(doc => {
                    const data = doc.data();
                    const li = document.createElement('li');
                    li.classList.add('complaint-item');
                    li.innerHTML = `
                        <span>Complaint from ${data.name || 'Anonymous'} (${data.email}) - Subject: ${data.subject}<br>Message: ${data.message}</span>
                        <div class="complaint-actions">
                            <button class="resolve" data-id="${doc.id}">Mark Resolved</button>
                            <button class="delete" data-id="${doc.id}">Delete</button>
                        </div>
                    `;
                    adminComplaintList.appendChild(li);
                });

                adminComplaintList.querySelectorAll('.resolve').forEach(button => {
                    button.addEventListener('click', async (e) => {
                        const complaintId = e.target.dataset.id;
                        if (confirm('Mark this complaint as resolved?')) {
                            try {
                                await db.collection("complaints").doc(complaintId).update({ status: 'resolved' }); // Add status field
                                alert('Complaint marked as resolved.');
                                loadComplaints();
                            } catch (error) {
                                console.error("Error resolving complaint:", error);
                                alert('Failed to mark complaint as resolved: ' + error.message);
                            }
                        }
                    });
                });

                adminComplaintList.querySelectorAll('.delete').forEach(button => {
                    button.addEventListener('click', async (e) => {
                        const complaintId = e.target.dataset.id;
                        if (confirm('Are you sure you want to delete this complaint?')) {
                            try {
                                await db.collection("complaints").doc(complaintId).delete();
                                alert('Complaint deleted successfully.');
                                loadComplaints();
                            } catch (error) {
                                console.error("Error deleting complaint:", error);
                                alert('Failed to delete complaint: ' + error.message);
                            }
                        }
                    });
                });
            } catch (error) {
                console.error("Error loading complaints:", error);
                adminComplaintList.innerHTML = '<li>Failed to load complaints.</li>';
            }
        }
        // Faculty Dashboard: Load Students (ONLY COPY TO DASHBOARD-FACULTY.HTML)
        async function loadFacultyStudents() {
            const facultyStudentList = document.getElementById('facultyStudentList');
            if (!facultyStudentList) return;

            facultyStudentList.innerHTML = '<li>Loading your students...</li>';
            try {
                // Assuming students have a 'facultyId' field linked to their faculty
                // This would require current user (faculty) context
                const currentUserUid = auth.currentUser ? auth.currentUser.uid : null;
                if (!currentUserUid) {
                    facultyStudentList.innerHTML = '<li>Please log in as a faculty member to view your students.</li>';
                    return;
                }
                const snapshot = await db.collection("users").where("role", "==", "student").where("facultyId", "==", currentUserUid).get();

                if (snapshot.empty) {
                    facultyStudentList.innerHTML = '<li>No students assigned to you.</li>';
                    return;
                }
                facultyStudentList.innerHTML = '';
                snapshot.forEach(doc => {
                    const data = doc.data();
                    const li = document.createElement('li');
                    li.innerHTML = `<span>${data.name || data.email}</span>`;
                    facultyStudentList.appendChild(li);
                });
            } catch (error) {
                console.error("Error loading faculty students:", error);
                facultyStudentList.innerHTML = '<li>Failed to load students.</li>';
            }
        }
    </script>
</body>
</html>
